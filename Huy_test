code edit by trung huy
